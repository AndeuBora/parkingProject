<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="qnaBoard">

	<!-- qna 글 목록 -->
	<select id="qnaBoardList" parameterType="com.parking.qnaBoard.vo.QnaBoardVO"
		resultType="com.parking.qnaBoard.vo.QnaBoardVO">
		select
		qnanum,
		qnatitle,
		to_char(qnawritedate, 'YYYY-MM-DD')
		as
		qnawritedate,
		memberId,
		qnawritepwd
		from (
		select list.*, rownum as rnum
		from (
		select qnanum, qnatitle,
		qnawritedate, memberId, qnawritepwd
		from qna
		order by
		qnawritedate desc
		) list
		)
		<where>
			<if test="start_row != null and start_row != ''">
				<if test="end_row != null and end_row != ''">
					rnum between #{start_row} and #{end_row}
				</if>
			</if>
		</where>
	</select>

	<!-- 전체 레코드 건수 -->
	<select id="qnaBoardCnt" parameterType="com.parking.qnaBoard.vo.QnaBoardVO"
		resultType="int">
		select nvl(count(1),0) from
		( select list.*, rownum as rnum
		from (
		select qnanum, qnatitle, to_char(qnawritedate, 'YYYY-MM-DD'
		)
		as qnawritedate, memberId
		from qna
		order by
		qnawritedate
		desc
		) list
		)
	</select>

	<!-- qna 글 등록 -->
	<insert id="qnaBoardInsert" parameterType="com.parking.qnaBoard.vo.QnaBoardVO">
		insert into qna
		(qnanum, qnatitle, qnacontent, qnawritedate, memberid,
		qnawritepwd)
		values (qnanum_seq.nextval, #{qnaTitle}, #{qnaContent}, sysdate,
		#{memberId}, #{qnaWritePwd})
	</insert>

	<!-- qna 글 상세보기 -->
	<select id="qnaBoardDetail" parameterType="com.parking.qnaBoard.vo.QnaBoardVO"
		resultType="com.parking.qnaBoard.vo.QnaBoardVO">
		select
		qnanum,
		qnatitle,
		to_char(qnawritedate, 'YYYY-MM-DD'
		)
		as qnawritedate,
		memberId,
		qnacontent,
		qnawritepwd
		from qna
		where qnanum =
		#{qnaNum}
	</select>

	<!-- qna 글 해당 번호의 비밀번호 확인 -->
	<select id="pwdConfirm" parameterType="com.parking.qnaBoard.vo.QnaBoardVO"
		resultType="int">
		select nvl((
		select 1 from qna
		where qnanum = #{qnaNum}
		and
		qnawritepwd = #{qnaWritePwd}
		), 0) as state
		from dual
	</select>

	<!-- qna 글 삭제하기 -->
	<delete id="qnaBoardDelete" parameterType="com.parking.qnaBoard.vo.QnaBoardVO">
		delete from qna
		where
		qnanum = #{qnaNum}
	</delete>

</mapper>
