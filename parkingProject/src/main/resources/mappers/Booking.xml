<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="BookingMapper">

	<select id="selectBookingSpot" parameterType="com.parking.booking.vo.BookingVO"
		resultType="com.parking.booking.vo.BookingVO">
		select bookingSpot
		from booking
		where bookingDate =
		#{selectDate}
	</select>

	<insert id="insertBooking" parameterType="com.parking.booking.vo.BookingVO">
		insert into booking
		(bookingNum,paymentNum,bookingState,bookingName,bookingPhone,bookingMoney,bookingDiscount,bookingSpot,applicationDate,bookingDate,bookingPolicy)
		values(#{bookingNum},#{paymentNum},0,#{bookingName},#{bookingPhone},#{bookingMoney},#{bookingDiscount},#{bookingSpot},sysdate,#{bookingDate},1)
	</insert>

	<!-- 나의예약목록조회 -->
	<select id="selectMyBookingList" parameterType="com.parking.booking.vo.BookingVO"
		resultType="com.parking.booking.vo.BookingVO">
		select * from
		booking
		<if test="memberNum">
			where memberNum=#{memberNum}
		</if>
		<if test="startDate">
			and bookingDate between #{startDate} and #{endDate}
		</if>
	</select>

	<!-- 전체레코드 건수 -->
	<select id="selectmyBookingListCnt" parameterType="com.parking.booking.vo.BookingVO"
		resultType="int">
		select nvl(count(1),0) from
		booking
		<trim prefix="where" prefixOverrides="and">
			<if test="memberNum">
				memberNum=#{memberNum}
			</if>
			<if test="startDate">
				<if test="endDate">
					AND bookingDate between #{startDate} and #{endDate}
				</if>
			</if>
		</trim>
	</select>
</mapper>
